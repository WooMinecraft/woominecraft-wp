language: php
php:
  - '7.0'
env:
  - RELEASE_PREFIX="woominecraft-prerelease-b"
before_script:
  - phpenv config-rm xdebug.ini
before_install:
  - npm i -g npm@7.5.3
cache:
  npm: false
  directories:
    - vendor
jobs:
  include:
    - stage: phplint
      script:
        - composer install
        - composer run-script phpcs
    - stage: build
      script:
        - npm install
        - node -v
        - npm -v
        - npm run build
#    - stage: deploy
#      if: branch =~ /^release\/.*$/
#      script:
#        - npm install && npm run build
#        - tar -cvzf $RELEASE_PREFIX$TRAVIS_BUILD_NUMBER.tar.gz -X build-excludes.txt woominecraft/
#      deploy:
#        provider: releases
#        api_key: $API_KEY
#        file: $RELEASE_PREFIX$TRAVIS_BUILD_NUMBER.tar.gz
#        skip_cleanup: true
#        draft: true
#        on:
#          tags: true
