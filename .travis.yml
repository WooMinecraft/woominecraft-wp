env:
  - RELEASE_PREFIX="woominecraft-prerelease-b"
before_script:
  - phpenv config-rm xdebug.ini
cache:
  npm: false
  directories:
    - vendor
matrix:
  include:
    - language: php
      php: 7.0
      before_script:
        - composer install
      script:
        - composer run-script phpcs
    - language: node_js
      node_js: 12
      before_script:
        - npm install
      script:
        - npm run build

# @TODO: Remove this and actually build packages when tags are created.
#jobs:
#  include:
#    - stage: phplint
#      script:
#        - composer install
#        - composer run-script phpcs
#    - stage: build
#      script:
#        - npm install
#        - npm run build
#    - stage: deploy
#      if: branch =~ /^release\/.*$/
#      script:
#        - npm install && npm run build
#        - tar -cvzf $RELEASE_PREFIX$TRAVIS_BUILD_NUMBER.tar.gz -X build-excludes.txt woominecraft/
#      deploy:
#        provider: releases
#        api_key: $API_KEY
#        file: $RELEASE_PREFIX$TRAVIS_BUILD_NUMBER.tar.gz
#        skip_cleanup: true
#        draft: true
#        on:
#          tags: true
